/*! arenajs - v0.1.0 - 2014-11-18
* https://github.com/jnylin/arena
* Copyright (c) 2014 Jakob Nylin; Licensed GPL */
function CatalogueRecord(a,b){this.element=a,this.subElements={title:$(".arena-"+b+"-title span:not(.arena-result-item-number)",this.element),originalTitle:$(".arena-detail-original .arena-value",this.element),author:$(".arena-"+b+"-author .arena-value",this.element),publisher:$(".arena-record-publisher .arena-value",this.element),year:$(".arena-"+b+"-year .arena-value",this.element),isbns:$(".arena-"+b+"-isbn .arena-value",this.element),media:$(".arena-"+b+"-media .arena-value",this.element),lang:$(".arena-"+b+"-language .arena-value",this.element)};var c,d,e,f,g,h,i,j,k=new RegExp("[0-9]{4}","i");switch(c=this.subElements.title.text().trim(),d=this.subElements.author.text(),e=this.subElements.publisher.text(),f=this.subElements.year.text(),i=this.subElements.media.text(),j=this.subElements.lang.text().trim(),b){case"record":g=this.subElements.isbns.text().split(", ");break;case"detail":g=[],$(this.subElements.isbns).each(function(){g.push($(this).text().trim())})}if(g)for(var l=0;l<g.length;l++){var m=g[l].replace(/-/g,"");if(13===m.length){h=m;break}}this.title=c,d&&(this.author={inverted:this.subElements.author.text(),lastname:this.subElements.author.text().split(",")[0].trim(),firstname:this.subElements.author.text().split(",")[1].substring(1).trim()}),e&&(this.publisher=e),f&&(this.year=k.exec(f)),i&&(this.media=i),j&&(this.lang=j),h&&(this.isbn=h),console.log(this),console.log(this.author)}function SearchResult(){this.init()}CatalogueRecord.prototype.decorate=function(){},CatalogueRecord.prototype.removeMediumFromTitle=function(){var a=this.subElements.title;a.text(a.text().replace(/\[.*\] ([\/:])/,"$1"))},CatalogueRecord.prototype.truncateTitle=function(){var a=new Title(this.title);this.subElements.title.html(truncate(a.main+" "+a.part,30))},CatalogueRecord.prototype.getSmakprov=function(a){new Smakprov(this.isbn,a)},Smakprov=function(a,b){var c=this;this.isbn=a,$.getJSON("/smakprov/v1/records?isbn="+this.isbn,c.callback(this,b))},Smakprov.prototype.callback=function(a,b){return function(c){if(c.length>0)switch(console.log("type = "+b),console.log("smakprov på "+a.getUrl()),b){case"detail":appendExternalRes(a.getUrl(),"Smakprov","Läs ett smakprov av boken","_blank","btnRead");break;case"list":}}},Smakprov.prototype.getUrl=function(){return"http://www.smakprov.se/smakprov.php?isbn="+this.isbn+"&l=vimmerby"},SearchResult.prototype.init=function(){$(".arena-library-record").each(function(){var a=new CatalogueRecord(this,"record");a.truncateTitle()})},SearchResult.prototype.smakprov=function(){},SearchResult.prototype.dvdCovers=function(){};